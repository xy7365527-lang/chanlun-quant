name: Codex Code Review

on:
  pull_request:
    types: [opened, synchronize, reopened]
  pull_request_review_comment:
    types: [created]
  issue_comment:
    types: [created]

jobs:
  codex-review:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pull-requests: write
      issues: write
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Codex Code Review
        uses: codex-team/codex-reviewer@v1
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          openai-api-key: ${{ secrets.OPENAI_API_KEY }}
          # å®¡æŸ¥çš„æ–‡ä»¶ç±»å‹
          include-patterns: |
            **/*.py
            **/*.js
            **/*.ts
            **/*.jsx
            **/*.tsx
          # æ’é™¤çš„æ–‡ä»¶å’Œç›®å½•
          exclude-patterns: |
            **/__pycache__/**
            **/node_modules/**
            **/dist/**
            **/build/**
            **/*.pyc
            **/package-lock.json
            **/uv.lock
          # å®¡æŸ¥è¯­è¨€è®¾ç½®ä¸ºä¸­æ–‡
          language: zh-CN
          # å®¡æŸ¥çº§åˆ«: strict, normal, lenient
          review-level: normal
          # è‡ªåŠ¨å›å¤ ğŸ‘ å½“ä»£ç è´¨é‡è‰¯å¥½æ—¶
          auto-approve: true

